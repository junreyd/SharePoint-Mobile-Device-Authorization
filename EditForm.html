<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" x-undefined="" />
<title>HideSPfields</title>
<link rel="stylesheet" type="text/css" href="/SiteAssets/junreyd/mobileStyle.css">

<style>
.sp-peoplepicker-delImage{
display:none;
}
.sp-peoplepicker-editorInput{
display:none;
}
.ms-ButtonHeightWidth{
  display: 
}
</style>

<!-- Start CDN Bootstrap and JS -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<!-- End CDN Bootstrap and JS -->

<!-- Start SharePoint Default -->
<script src="/SiteAssets/Scripts/jquery.min.js" type="text/javascript"></script> ​​
<script src="/SiteAssets/Scripts/jquery.timeago.js" type="text/javascript"></script>
<script src="/SiteAssets/sputility.min.js"></script>
<script src="/_layouts/15/SP.dateTimeUtil.js" type="text/javascript"></script>
<!-- End SharePoint Default -->
</head>

<body>

  <div id="cookieConsent">
    <div id="closeCookieConsent"></div>
    You cannot update this form once <b>CSO</b> is on Approval.&nbsp;&nbsp;&nbsp;<a href="#" target="_blank">More info please contact SharePoint Team</a>. <a class="cookieConsentOK">That's Fine</a>
  </div>

  <div class="container">
    <div class="row">
      <div class="table-responsive">  
        <div class="container" style="width: 70%!important; height: 500%!important; margin-right: 100%;">
          <div class="table-wrapper">
        <table class="table table-striped table-hover">
          <div class="table-title">
            <div class="row">
              <div class="col-sm-6">
              <h2><i class="glyphicon glyphicon-phone"></i>&nbsp;&nbsp;Mobile Authorization <b>Form</b></h2>
              </div>
            </div>
          </div>
        <table>
          <div class="conta">
          <tr>
              <td>
                <div class="form-group">
                  <b>Notification from:</b>
                  <span class="hillbillyForm" data-displayName="Notification from"></span>
                </div>
              </td>
          </tr>
          <tr>
              <td>
                <div class="form-group">
                  <b>Employee:</b>
                  <span class="hillbillyForm" data-displayName="Employee"></span>
                </div>
              </td>
          </tr>
          <tr>
              <td>
                <div class="form-group">
                  <b>Department:</b>
                  <span class="hillbillyForm" data-displayName="Department"></span>
                </div>
              </td>
          </tr>
          <tr>
              <td>
                <div class="form-group">
                  <b>Ownership:</b>
                  <span class="hillbillyForm" data-displayName="Ownership"></span>
                </div>
              </td>
          </tr>
          <tr>
              <td>
                <div class="form-group">
                  <b>Purpose:</b>
                  <span class="hillbillyForm" data-displayName="Purpose"></span>
                </div>
              </td>
          </tr>
          <tr>
            <td>
              <div class="form-group" id="form-group1">          
                <b>CSO Approval</b>
                <span class="hillbillyForm" data-displayName="CSO Approval"></span> 
              </div>
            </td>
          </tr>
          <tr>
            <td>
              <div class="form-group" id="asdf">
                <b>Rejected reason</b>
                <span class="hillbillyForm" data-displayName="Rejected reason"></span>
              </div>
            </td>
          </tr>
      </div>
  </table>
</body>
<script type="text/javascript">
//start Change Save to Submit
(function ($, undefined) {
  $("document").ready(function () {
var inputcontrols = document.getElementsByTagName("input");
  for(i = 0; i<inputcontrols.length; i++) {
    if(inputcontrols[i].type == "button" && inputcontrols[i].value == "Save")
    inputcontrols[i].value = "Submit";
  }
var ribbonSave = $("span.ms-cui-ctl-largelabel:contains('Save')");
ribbonSave.text("Submit");
});})(jQuery);
//start Change Save to Submit

//start get data from SharePoint
  $(document).ready(function() {
  $("span.hillbillyForm").each(function() {
  displayName = $(this).attr("data-displayName");
  displayName  = displayName.replace(/&(?!amp;)/g,'&amp;'); 
  elem = $(this);
  $("table.ms-formtable td").each(function(){ if (this.innerHTML.indexOf('FieldName="'+displayName+'"') != -1){ $(this).contents().appendTo(elem); } }); }); 
//end get data from SharePoint

  document.getElementById('asdf').style.display = 'none';
  $("select[id='CSO_x0020_Approval_adc398f4-439a-45f0-92bb-1b4b03681789_$DropDownChoice']").change(function () {
  var value = this.value;
    if(value === "Reject") {
      document.getElementById('asdf').style.display = 'block';
    } else {
      document.getElementById('asdf').style.display = 'none';
    }
});

  var value = $("select[title='CSO Approval'] option:selected").text();
  document.getElementById('asdf').style.display = 'none';

    if(value === "") {
        document.getElementById('CSO_x0020_Approval_adc398f4-439a-45f0-92bb-1b4b03681789_$DropDownChoice').disabled = false;
    } else if (value === "Reject") {
        document.getElementById('CSO_x0020_Approval_adc398f4-439a-45f0-92bb-1b4b03681789_$DropDownChoice').disabled = true;
        document.getElementById('asdf').style.display = 'block';
    } else {
        document.getElementById('CSO_x0020_Approval_adc398f4-439a-45f0-92bb-1b4b03681789_$DropDownChoice').disabled = true;
    } 
});  


var userProfileProperties;
ExecuteOrDelayUntilScriptLoaded(init,'sp.js');
var targetUser;

  function init() {
    this.clientContext2 = new SP.ClientContext.get_current();
    this.oWeb = clientContext2.get_web();
    targetUser = this.oWeb.get_currentUser();
    this.clientContext2.load(targetUser);
    this.clientContext2.executeQueryAsync(Function.createDelegate(this,this.onQuerySucceeded), Function.createDelegate(this,this.onQueryFailed));
  }

  function onQuerySucceeded() {
    var account = targetUser.get_loginName();
    targetUser_temp = account.substring(account.indexOf("|") + 10);
    targetUser = targetUser_temp;

    document.getElementById("Ribbon.ListForm.Edit.Commit.Publish-Large").style.display="none";
    $("input[value$='Save']").attr('disabled', true);
    var value = $("select[title='CSO Approval'] option:selected").text();
    document.getElementById('asdf').style.display = 'none';

    if(targetUser == "scotto" || targetUser == "nowmarc" || targetUser == "junreyd" || targetUser == "litoa") { 
      $("div #form-group1").show(); 
      $("input[value$='Submit']").attr('disabled', false);

      if(value == "") {
        $("input[id='Notification_x0020_from_2d32e422-61cd-4615-aef3-33820967b4b2_$TextField']").attr('disabled', true);
        $("select[id='Department_7133ed87-a7fb-4cdd-bc9a-45fbe7587bec_$LookupField']").attr('disabled', true);
        $("select[id='Ownership_2c8e1b4c-63a9-4bc2-9d1f-e0629631121c_$DropDownChoice']").attr('disabled', true);
        $("div[id='Purpose_10833922-496e-4469-bfb5-5254901670d7_$TextField_inplacerte']").attr('contenteditable', false);
      } else if (value == "Approved") {
          $("input[value$='Submit']").attr('disabled', true); 
        }
        else if (value == "Reject") {
          $("input[value$='Submit']").attr('disabled', true); 
          $("#asdf").show(); 
        }
      }

    else if(targetUser === "artems" || targetUser === "mithis" || targetUser === "alinf" || targetUser === "System Account" || targetUser === "aysoukhomlinov" || targetUser === "nowmarc" || targetUser === "junreyd" || targetUser === "litoa" ||) {        

      if(value == "") {
        $("#asdf").hide();
        $("#form-group1").hide();
        $("input[value$='Submit']").attr('disabled', false);
      } else if(value == "Approved") {
          $("#form-group1").show();
          $("input[value$='Submit']").attr('disabled', true);
          $("#cookieConsent").fadeIn(200);
          $("#closeCookieConsent, .cookieConsentOK").click(function() {
          $("#cookieConsent").fadeOut(200);
          });
          document.getElementById('CSO_x0020_Approval_adc398f4-439a-45f0-92bb-1b4b03681789_$DropDownChoice').disabled = true;
          $("input[value$='Submit']").attr('disabled', true); 
        } else if(value == "Reject") {
          $("input[value$='Submit']").attr('disabled', true);
          $("#cookieConsent").fadeIn(200);
          $("#closeCookieConsent, .cookieConsentOK").click(function() {
          $("#cookieConsent").fadeOut(200);
          });
          document.getElementById('CSO_x0020_Approval_adc398f4-439a-45f0-92bb-1b4b03681789_$DropDownChoice').disabled = true;
          $("#form-group1").show(); 
          $("#asdf").show(); 
        }
          $("input[id='Notification_x0020_from_2d32e422-61cd-4615-aef3-33820967b4b2_$TextField']").attr('enabled', true);
          $("select[id='Department_7133ed87-a7fb-4cdd-bc9a-45fbe7587bec_$LookupField']").attr('enabled', true);
          $("select[id='Ownership_2c8e1b4c-63a9-4bc2-9d1f-e0629631121c_$DropDownChoice']").attr('enabled', true);
          $("div[id='Purpose_10833922-496e-4469-bfb5-5254901670d7_$TextField_inplacerte']").attr('contenteditable', true);
          $(".sp-peoplepicker-delImage").css({ 'display' : 'inline'});
          $(".sp-peoplepicker-editorInput").css({ 'display' : 'inline'});
          } else {
            $("input[id='Notification_x0020_from_2d32e422-61cd-4615-aef3-33820967b4b2_$TextField']").attr('disabled', true);
            $("select[id='Department_7133ed87-a7fb-4cdd-bc9a-45fbe7587bec_$LookupField']").attr('disabled', true);
            $("select[id='Ownership_2c8e1b4c-63a9-4bc2-9d1f-e0629631121c_$DropDownChoice']").attr('disabled', true);
            $("div[id='Purpose_10833922-496e-4469-bfb5-5254901670d7_$TextField_inplacerte']").attr('contenteditable', false);
          }
        }
  </script>
</html>
